<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diego Lera-Lozano">

<title>Genomic Exploration of TBP Producing Bacteria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Notebook_files/libs/clipboard/clipboard.min.js"></script>
<script src="Notebook_files/libs/quarto-html/quarto.js"></script>
<script src="Notebook_files/libs/quarto-html/popper.min.js"></script>
<script src="Notebook_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Notebook_files/libs/quarto-html/anchor.min.js"></script>
<link href="Notebook_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Notebook_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Notebook_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Notebook_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Notebook_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#project-details" id="toc-project-details" class="nav-link active" data-scroll-target="#project-details">Project Details</a>
  <ul>
  <li><a href="#project-breakdown" id="toc-project-breakdown" class="nav-link" data-scroll-target="#project-breakdown">Project Breakdown</a></li>
  </ul></li>
  <li><a href="#read-quality-control" id="toc-read-quality-control" class="nav-link" data-scroll-target="#read-quality-control">Read Quality Control</a>
  <ul>
  <li><a href="#basecalling" id="toc-basecalling" class="nav-link" data-scroll-target="#basecalling">Basecalling</a></li>
  <li><a href="#trimming" id="toc-trimming" class="nav-link" data-scroll-target="#trimming">Trimming</a></li>
  </ul></li>
  <li><a href="#assembly-workflow" id="toc-assembly-workflow" class="nav-link" data-scroll-target="#assembly-workflow">Assembly Workflow</a>
  <ul>
  <li><a href="#k-mer-assembly" id="toc-k-mer-assembly" class="nav-link" data-scroll-target="#k-mer-assembly">K-mer Assembly</a></li>
  <li><a href="#assembly" id="toc-assembly" class="nav-link" data-scroll-target="#assembly">Assembly</a></li>
  <li><a href="#alignment-and-polishing" id="toc-alignment-and-polishing" class="nav-link" data-scroll-target="#alignment-and-polishing">Alignment and Polishing</a></li>
  <li><a href="#circularization" id="toc-circularization" class="nav-link" data-scroll-target="#circularization">Circularization</a></li>
  </ul></li>
  <li><a href="#assembly-quality-assessment" id="toc-assembly-quality-assessment" class="nav-link" data-scroll-target="#assembly-quality-assessment">Assembly Quality Assessment</a>
  <ul>
  <li><a href="#blobtools-prep" id="toc-blobtools-prep" class="nav-link" data-scroll-target="#blobtools-prep">Blobtools Prep</a></li>
  <li><a href="#blobtools" id="toc-blobtools" class="nav-link" data-scroll-target="#blobtools">Blobtools</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#checkm" id="toc-checkm" class="nav-link" data-scroll-target="#checkm">CheckM</a></li>
  <li><a href="#assembly-assesment" id="toc-assembly-assesment" class="nav-link" data-scroll-target="#assembly-assesment">Assembly Assesment</a></li>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  <li><a href="#table-of-final-assemblies" id="toc-table-of-final-assemblies" class="nav-link" data-scroll-target="#table-of-final-assemblies">Table of Final Assemblies</a></li>
  </ul></li>
  <li><a href="#taxonomic-classification" id="toc-taxonomic-classification" class="nav-link" data-scroll-target="#taxonomic-classification">Taxonomic Classification</a>
  <ul>
  <li><a href="#classify-results" id="toc-classify-results" class="nav-link" data-scroll-target="#classify-results">Classify Results</a>
  <ul>
  <li><a href="#bc01-3" id="toc-bc01-3" class="nav-link" data-scroll-target="#bc01-3">BC01</a></li>
  <li><a href="#bc02-3" id="toc-bc02-3" class="nav-link" data-scroll-target="#bc02-3">BC02</a></li>
  <li><a href="#bc03-3" id="toc-bc03-3" class="nav-link" data-scroll-target="#bc03-3">BC03</a></li>
  </ul></li>
  <li><a href="#classify-discussion" id="toc-classify-discussion" class="nav-link" data-scroll-target="#classify-discussion">Classify Discussion</a></li>
  <li><a href="#blasting-individual-contigs" id="toc-blasting-individual-contigs" class="nav-link" data-scroll-target="#blasting-individual-contigs">Blasting Individual Contigs</a>
  <ul>
  <li><a href="#bc01-4" id="toc-bc01-4" class="nav-link" data-scroll-target="#bc01-4">BC01</a></li>
  <li><a href="#bc02-4" id="toc-bc02-4" class="nav-link" data-scroll-target="#bc02-4">BC02</a></li>
  <li><a href="#bc03-4" id="toc-bc03-4" class="nav-link" data-scroll-target="#bc03-4">BC03</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#genome-annotation" id="toc-genome-annotation" class="nav-link" data-scroll-target="#genome-annotation">Genome Annotation</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Genomic Exploration of TBP Producing Bacteria</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diego Lera-Lozano </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="project-details" class="level1">
<h1>Project Details</h1>
<p>This project delves into the genomic makeup of three bacteria that produce tetrabromopyrrole (TBP), a molecule that is linked in aiding coral settlement. In this project we aim to assemble the genome, classify the bacteria, and finally annotate their respective genome to facilitate further study using these bacteria and/or similar bacteria.</p>
<section id="project-breakdown" class="level3">
<h3 class="anchored" data-anchor-id="project-breakdown">Project Breakdown</h3>
<p>The project can be broken up into the following sections</p>
<ul>
<li>Read Quality Control</li>
<li>Assembly Generation</li>
<li>Alignment, Polishing, and Circularization</li>
<li>Assembly Quality Assessment</li>
<li>Taxonomic Classification</li>
<li>Genome Annotation</li>
</ul>
</section>
</section>
<section id="read-quality-control" class="level1">
<h1>Read Quality Control</h1>
<p>Jordan Ruiz Toquica extracted the DNA of bacterial strains CCAH7, CCAH11, CCAH3 provided by Kimberly Ritchie. The Bacterial DNA was then prepped for a Nanopore sequencing where each strain recieved a barcode assignment. CCAH7 as barcode01, CCAH11 as barcode02, CCAH3 as barcode03. Finally the DNA was sequenced by Jordan Ruiz Toquica using the MINion in the Medina Lab at Pennsylvania State University.</p>
<section id="basecalling" class="level3">
<h3 class="anchored" data-anchor-id="basecalling">Basecalling</h3>
<p>Once the MINion generated reads in the .fastq format through the use of their basecalling model guppy we ran FastQC to generate a report to asses the quality of the reads.</p>
<p>What we found was that the guppy model generated poor quality reads that would not be viable downstream. Due to this we took the original .pod5 files generated by the MINion and re-did the basecalling using dorado.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Read Quality Reports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Basecalling Script</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">FastQC Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><img src="guppycalledreport.png" class="img-fluid" style="width:40.0%" alt="Image 1"> | <img src="dorado.png" class="img-fluid" style="width:54.0%" alt="Image 2"></p>
<p>This view shows an overview of the range of quality values across all bases at each position in the fastq reads file. On the left we have the Guppy basecalled reads then on the right we have the Dorado basecalled reads.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=24
#SBATCH --time=24:00:00
#SBATCH --mem=250G

date

#Variables
export MODEL=dna_r10.4.1_e8.2_400bps_sup@v4.2.0
export INDIR=path/to/XXXXX_pass_barcode01.pod5
export OUT=barcode01.fastq.gz

#Commands
dorado duplex -t $SLURM_NTASKS -x "cpu" --emit-fastq $MODEL $INDIR | gzip &gt; $OUT

date</code></pre>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<pre><code>fastqc barcode01.fastq.gz
</code></pre>
</div>
</div>
</div>
</section>
<section id="trimming" class="level3">
<h3 class="anchored" data-anchor-id="trimming">Trimming</h3>
<p>After analyzing the quality graphs produced by FastQC it was clear that the beginning of the reads generated by Dorado were still of low quality. Due to this we decided to use chopper to trim our reads and found a trim of 100bp to be the best for conserving the reads while removing the low quality bit.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Read Quality Reports</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Per Base Sequence</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">FastQC Stats</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Trimming Script</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false" href="">FastQC Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><img src="dorado.png" class="img-fluid" style="width:47.0%" alt="Image 1"> | <img src="BC1_trim.png" class="img-fluid" style="width:47.0%" alt="Image 2"></p>
<p>This view shows an overview of the range of quality values across all bases at each position in the fastq reads file. On the left we have the before-trim reads then on the right we have the 100bp-trim reads.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><img src="pretrim_base_content.png" class="img-fluid" style="width:40.0%" alt="Image 1"> | <img src="posttrim_base_content.png" class="img-fluid" style="width:54.0%" alt="Image 2"></p>
<p>This view shows the per base sequence content across all reads at each position in the fastq reads file. On the left we have the before-trim reads then on the right we have the 100bp-trim reads.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<table class="table">
<caption>Statistics generated by FastQC pertaining to trimmed reads</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">BC01</th>
<th style="text-align: center;">BC02</th>
<th style="text-align: center;">BC03</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total Sequences</td>
<td style="text-align: center;">564,295</td>
<td style="text-align: center;">432,709</td>
<td style="text-align: center;">74,466</td>
</tr>
<tr class="even">
<td>Total Bases (Gbp)</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">0.42</td>
</tr>
<tr class="odd">
<td>Sequence Length</td>
<td style="text-align: center;">1-31781</td>
<td style="text-align: center;">1-39369</td>
<td style="text-align: center;">5-38990</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<pre><code>
#!/bin/bash
#SBATCH --job-name=trim_B1
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=6
#SBATCH --time=10:00:00
#SBATCH --mem=50G

date

#Variables
export BASE_TRIMMER=path/to/chopper
export TRIM_LENGTH=100
export CONTAMINATE_SEQUENCES=path/to/nanopore_adapters.fasta
export INDIR=path/to/barcode01.fastq.gz
export OUTDIR=barcode01_trimmed100.fastq.gz

#Commands
gunzip -c $INDIR | $BASE_TRIMMER --headcrop $TRIM_LENGTH --tailcrop $TRIM_LENGTH --contam $CONTAMINATE_SEQUENCES | gzip &gt; $OUTDIR

date
</code></pre>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<pre><code>fastqc barcode01_trimmed100.fastq.gz
</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="assembly-workflow" class="level1">
<h1>Assembly Workflow</h1>
<section id="k-mer-assembly" class="level3">
<h3 class="anchored" data-anchor-id="k-mer-assembly">K-mer Assembly</h3>
<p>Before we begin putting together an assembly we first had to get an approximate genome length to this we used jellyfish for a K-mer analysis using 25-mers.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">BC01</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">BC02</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">BC03</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false" href="">Jellyfish Pipeline</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC01_Kmer.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">25-mer analysis</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC02_Kmer.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">25-mer analysis</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC03_Kmer.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">25-mer analysis</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<pre><code>jellyfish count -t 10 -C -m 25 -s 1G barcode01_trimmed100.fastq -o 25mer_out.jf
jellyfish histo -h 1000000 -t 10 25mer_out.jf &gt; barcode01.histo
</code></pre>
<p>I ran these lines within a slurm allocation instead of a script due to unique errors when I attempted to submit a slurm job script with these commands</p>
</div>
</div>
</div>
</section>
<section id="assembly" class="level3">
<h3 class="anchored" data-anchor-id="assembly">Assembly</h3>
<p>Once we came up with approximate genome sizes using jellyfish we decided to use flye as our assembler.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">BC01</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">BC02</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">BC03</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href="">Flye Script</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>length</th>
<th>COV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_1</td>
<td>4,903,516</td>
<td>636</td>
</tr>
<tr class="even">
<td>Contig_4</td>
<td>521,089</td>
<td>626</td>
</tr>
<tr class="odd">
<td>Contig_3</td>
<td>467,542</td>
<td>628</td>
</tr>
<tr class="even">
<td>Contig_2</td>
<td>6,778</td>
<td>546</td>
</tr>
</tbody>
</table>
<p>Flye assembly info pertaining to barcode01 retrieved from assembly_info.txt file generated during assembly</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>length</th>
<th>COV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_1</td>
<td>3,527,231</td>
<td>499</td>
</tr>
<tr class="even">
<td>Contig_4</td>
<td>1,216,057</td>
<td>510</td>
</tr>
<tr class="odd">
<td>Contig_2</td>
<td>928,174</td>
<td>492</td>
</tr>
<tr class="even">
<td>Contig_5</td>
<td>20,286</td>
<td>594</td>
</tr>
</tbody>
</table>
<p>Flye assembly info pertaining to barcode02 retrieved from assembly_info.txt file generated during assembly</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>length</th>
<th>COV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_2</td>
<td>3,160,323</td>
<td>82</td>
</tr>
<tr class="even">
<td>Contig_3</td>
<td>1,214,135</td>
<td>91</td>
</tr>
<tr class="odd">
<td>Contig_5</td>
<td>42,348</td>
<td>1150</td>
</tr>
</tbody>
</table>
<p>Flye assembly info pertaining to barcode03 retrieved from assembly_info.txt file generated during assembly</p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=flye_0X
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=12
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export PFX=BC01
export GS=5.778m
export READS=/path/to/barcode01_trimmed100.fastq.gz

#Commands
/path/to/flye --nano-raw $READS --genome-size $GS --asm-coverage 200 -t 12 --out-dir /path/to/outdir</code></pre>
</div>
</div>
</div>
</section>
<section id="alignment-and-polishing" class="level3">
<h3 class="anchored" data-anchor-id="alignment-and-polishing">Alignment and Polishing</h3>
<p>Once assemblies were generated we decided to align and polish the assemblies using minimap2 and racon respectfully. We then used bbmap’s stats.sh feature to generate basic assembly information to investigate the effect of minimap2 and racon on our assembly during each alignment and polishing round.</p>
<p>The procedure went as follows: First Alignment → First Polish → Second Alignment … → Third Polish</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Assembly Statistics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Align (1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Polish (1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href="">Align (2)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false" href="">Polish (2)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false" href="">Align (3)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false" href="">Polish (3)</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>BCOX_A&amp;P#</th>
<th>BC01</th>
<th>BC01 (1)</th>
<th>BC01 (2)</th>
<th>BC01 (3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GC</td>
<td>0.5242</td>
<td>0.5242</td>
<td>0.5242</td>
<td>0.5242</td>
</tr>
<tr class="even">
<td>GC_stdev</td>
<td>0.0038</td>
<td>0.003</td>
<td>0.0021</td>
<td>0.0026</td>
</tr>
<tr class="odd">
<td>Contig Total</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="even">
<td>Total N/L50 (MB)</td>
<td>1/4.904</td>
<td>1/4.903</td>
<td>1/4.903</td>
<td>1/4.903</td>
</tr>
<tr class="odd">
<td>Max Contig Length (MB)</td>
<td>4.904</td>
<td>4.903</td>
<td>4.903</td>
<td>4.903</td>
</tr>
<tr class="even">
<td>Number of Contig &gt; 50 KB</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td>% main genome in contigs &gt; 50 KB</td>
<td>99.89</td>
<td>99.89</td>
<td>99.9</td>
<td>99.91</td>
</tr>
<tr class="even">
<td>Total Sequence Length</td>
<td>5,898,925</td>
<td>5,898,127</td>
<td>5,897,552</td>
<td>5,896,968</td>
</tr>
</tbody>
</table>
<p>Table of assembly statistics generated by stats.sh from bbmap pertaining to the first barcode. It is important to note that this pattern was consistent with all barcodes.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_minimap3
#SBATCH --nodes=1
#SBATCH --ntasks=12
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export ASSEMBLY=/path/to/assembly.fasta
export PFX=BC01
export READS=/path/to/barcode01_trimmed100.fastq.gz

#Commands
/path/to/minimap2 -t $SLURM_NTASKS $ASSEMBLY $READS &gt; ${PFX}.paf</code></pre>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_racon
#SBATCH --nodes=1
#SBATCH --ntasks=4
#SBATCH --time=20:00:00
#SBATCH --mem=24G

date

#Variables
export PFX=BC01
export ASSEMBLY=/path/to/assembly.fasta
export PAF=BC01.paf
export READS=/path/to/barcode01_trimmed100.fastq.gz
export OUT=${PFX}_racon1.fasta

#Commands
racon -t $SLURM_NTASKS $READS $PAF $ASSEMBLY &gt; $OUT</code></pre>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_minimap
#SBATCH --nodes=1
#SBATCH --ntasks=12
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export ASSEMBLY=./BC01_racon1.fasta
export PFX=BC01_R1
export READS=/path/to/barcode01_trimmed100.fastq.gz

#Commands
/path/to/minimap2 -t $SLURM_NTASKS $ASSEMBLY $READS &gt; ${PFX}.paf</code></pre>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_racon
#SBATCH --nodes=1
#SBATCH --ntasks=8
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export PFX=BC01
export ASSEMBLY=BC01_racon1.fasta
export PAF=BC01_R1.paf
export READS=/path/to/barcode01_trimmed100.fastq.gz
export OUT=BC01_racon2.fasta

#Commands
racon -t $SLURM_NTASKS $READS $PAF $ASSEMBLY &gt; $OUT</code></pre>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_minimap
#SBATCH --nodes=1
#SBATCH --ntasks=12
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export ASSEMBLY=./BC01_racon2.fasta
export PFX=BC01_R2
export READS=/path/to/barcode01_trimmed100.fastq.gz

#Commands
/path/to/minimap2 -t $SLURM_NTASKS $ASSEMBLY $READS &gt; ${PFX}.paf</code></pre>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_racon
#SBATCH --nodes=1
#SBATCH --ntasks=8
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export PFX=BC01
export ASSEMBLY=BC01_racon2.fasta
export PAF=BC01_R2.paf
export READS=/path/to/barcode01_trimmed100.fastq.gz
export OUT=BC01_racon3.fasta

#Commands
racon -t $SLURM_NTASKS $READS $PAF $ASSEMBLY &gt; $OUT</code></pre>
</div>
</div>
</div>
</section>
<section id="circularization" class="level3">
<h3 class="anchored" data-anchor-id="circularization">Circularization</h3>
<p>Once we aligned and polished the assemblies we decided to circularize both the non-polished and polished assemblies using canu to compare it to flye’s circularization algorithm while simultaneously being able to circularize the polished assemblies which were not circularized by racon.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Circularization Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Script</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>KEY:</p>
<ul>
<li>Y = Circularized</li>
<li>N = Not Circularized</li>
<li>X = Contig DNE</li>
<li>* = Main Chromosome</li>
<li>- = No Data</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>BC01_0P_0C</th>
<th>BC01_1P_0C</th>
<th>BC01_0P_1C</th>
<th>BC01_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_1</td>
<td>Y*</td>
<td>-</td>
<td>Y*</td>
<td>Y*</td>
</tr>
<tr class="even">
<td>Contig_2</td>
<td>Y</td>
<td>-</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>Contig_3</td>
<td>Y</td>
<td>-</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="even">
<td>Contig_4</td>
<td>Y</td>
<td>-</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>Contig_5</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>BC02_0P_0C</th>
<th>BC02_1P_0C</th>
<th>BC02_0P_1C</th>
<th>BC02_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_1</td>
<td>N*</td>
<td>-</td>
<td>N*</td>
<td>N*</td>
</tr>
<tr class="even">
<td>Contig_2</td>
<td>N</td>
<td>-</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="odd">
<td>Contig_3</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="even">
<td>Contig_4</td>
<td>Y</td>
<td>-</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>Contig_5</td>
<td>N</td>
<td>-</td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
<table class="table">
<thead>
<tr class="header">
<th>Contig</th>
<th>BC03_0P_0C</th>
<th>BC03_1P_0C</th>
<th>BC03_0P_1C</th>
<th>BC03_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contig_1</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="even">
<td>Contig_2</td>
<td>N*</td>
<td>-</td>
<td>N*</td>
<td>N*</td>
</tr>
<tr class="odd">
<td>Contig_3</td>
<td>N</td>
<td>-</td>
<td>N</td>
<td>N</td>
</tr>
<tr class="even">
<td>Contig_4</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="odd">
<td>Contig_5</td>
<td>Y</td>
<td>-</td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<pre><code>#!/bin/bash
#SBATCH --job-name=circle_01
#SBATCH --nodes=1
#SBATCH --ntasks=18
#SBATCH --time=20:00:00
#SBATCH --mem=100G

#Circlator Dependencies
export PATH=$PATH:/path/to/canu-1.7.1/Linux-amd64/bin
export PATH=$PATH:/path/to/programs
export PATH=$PATH:/path/to/bwa
module load samtools

#Variables
export ASSEMBLY=/path/to/barcode01/assembly.fasta
export READS=/path/to/barcode01/barcode01_trimmed100.fastq
export OUTPUT=/path/to/circulization/BC1_INITIAL

#Command
circlator all --assembler canu --threads $SLURM_NTASKS $ASSEMBLY $READS $OUTPUT

</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="assembly-quality-assessment" class="level1">
<h1>Assembly Quality Assessment</h1>
<p>To generate all data to assess our assemblies we used the following tools for the following reasons:</p>
<ul>
<li>Minimap2: Generation of a .sam alignment file for downstream analysis such as blobtools</li>
<li>Samtools: Conversion, Sorting, and Indexing of the .sam alignment file into a binary .bam file accepted by genomic tools</li>
<li>Blastn: Allows us to make loose taxonomic assignments of the bacteria and their plasmids, also generates a file needed for blobtools</li>
<li>Blobtools: Allows us to visualize each contig separately allowing us to check for contamination and possible plasmids</li>
<li>BBmap: Through the use of BBmap’s stats.sh script we can generate several assembly stats for a quality assessment</li>
<li>CheckM: Using CheckM we will generate several assembly stats that will allow us to make a quality assesment.</li>
</ul>
<section id="blobtools-prep" class="level3">
<h3 class="anchored" data-anchor-id="blobtools-prep">Blobtools Prep</h3>
<p>All of the blobtools preparation was done in a slurm allocation of 50GB minus the Minimap2 alignment.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Minimap2 Script</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Samtools Pipeline</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Blastn Pipeline</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>We will generate a .sam alignment file for downstream analysis such as blobtools</p>
<pre><code>
#!/bin/bash
#SBATCH --job-name=BC01_minimappin
#SBATCH --nodes=1
#SBATCH --ntasks=12
#SBATCH --time=20:00:00
#SBATCH --mem=50G

date

#Variables
export ASSEMBLY=/path/to/assembly.fasta
export PFX=BC01_BLOB
export READS=/path/to/barcode01/barcode01_trimmed100.fastq

#Commands
/path/to/minimap2 -a -t $SLURM_NTASKS $ASSEMBLY $READS &gt; ${PFX}.sam
</code></pre>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>We will be Converting, Sorting, and Indexing the .sam alignment file into a binary .bam file accepted by genomic tools using Samtools</p>
<pre><code>
samtools view -b BC01_BLOB.sam &gt; BC01_BLOB.bam
samtools sort -o Sorted_BC01_BLOB.bam BC01_BLOB.bam
samtools index Sorted_BC01_BLOB.bam
</code></pre>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>We will be generating blastn .tsv files for blobtools to use and we will discuss the result of the whole genome blast in the taxonomic classification section. We will be using the nt database downloaded via this command: update_blastdb.pl -d nt, which downloaded the nt database on 1/24/24</p>
<pre><code>
#!/bin/bash
#SBATCH --job-name=BC01_blast
#SBATCH --nodes=1
#SBATCH --ntasks=18
#SBATCH --time=20:00:00
#SBATCH --mem=100G

#Variables
export QUERY = /path/to/minimap2/06.fixstart.fasta
export DATABASE = /path/to/minimap2/database/nt
export OUT_FORMAT = '6 qseqid staxids bitscore std'
export MAX_TARGET = 10
export MAX_HSPS = 1
export EVAL = 1e-25
export OUTPUT = .tsv

#Command
blastn -query $QUERY -db $DATABASE -outfmt $OUT_FORMAT -max_target_seqs $MAX_TARGET -max_hsps $MAX_HSPS -evalue $EVAL -out $OUTPUT
</code></pre>
</div>
</div>
</div>
</section>
<section id="blobtools" class="level3">
<h3 class="anchored" data-anchor-id="blobtools">Blobtools</h3>
<p>In this section we used blobtools to assess whether or not we had contamination/if our contigs may pertain to plasmids. Blob tools node and names data was downloaded via following the github’s instruction on 12/27/23</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">BC01 Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">BC02 Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">BC03 Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false" href="">Blobtools script</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC01_blob_plot_species.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">BC01 Blob Plot</figcaption>
</figure>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC02_blob_plot_species.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">BC02 Blob Plot</figcaption>
</figure>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="BC03_blob_plot_species.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">BC03 Blob Plot</figcaption>
</figure>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<pre><code>
blobtools create -i /PATH/TO/assembly.fasta -b /PATH/TO/alignment.bam -t /PATH/TO/blast.tsv -o ./blob_create --names /PATH/TO/blob_data/names.dmp --nodes /PATH/TO/blob_data/nodes.dmp

blobtools view -i ./blob_create.blobDB.json -r 'species' -o ./view_species
blobtools plot -i ./blob_create.blobDB.json -r 'species' -o ./blob_plot_species
blobtools view -i ./blob_create.blobDB.json -r 'genus' -o ./view_genus
blobtools plot -i ./blob_create.blobDB.json -r 'genus' -o ./blob_plot_genus

</code></pre>
</div>
</div>
</div>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion">Discussion</h3>
<p>After assessing each plot it seems as if our samples were not contaminated <em>phew</em> and that the different colored blobs belonged to plasmids. We reached this conclusion due the large blobs all pertaining to one taxon while the small blobs pertained to others. This will be further investigated by blasting the contigs separately in a future section.</p>
</section>
<section id="checkm" class="level3">
<h3 class="anchored" data-anchor-id="checkm">CheckM</h3>
<p>Using CheckM we generated several assembly stats that will allow us to make a quality assesment. This was done using a slurm job allocation of 50GB and CheckM’s database downloaded on 12/28/2023 from here: https://data.ace.uq.edu.au/</p>
<p>The following pipeline was ran within a directory containing the .fasta assembly file in a bins sub-directory</p>
<pre><code>
checkm lineage_wf -t 8 -x fasta ./bins ./output
checkm tetra -t 8 ./bins/assembly.fasta tetra.tsv
checkm coding_plot -x fasta ./output ./bins ./plot 9
checkm tetra_plot -x fasta ./output ./bins ./tetraplot tetra.tsv 95
checkm gc_plot -x fasta ./bins ./gc_plots 95
</code></pre>
</section>
<section id="assembly-assesment" class="level3">
<h3 class="anchored" data-anchor-id="assembly-assesment">Assembly Assesment</h3>
<p>The following assembly statistics were generated via their respective tools</p>
<ul>
<li>Completeness (%): CheckM</li>
<li>Contamination (%): CheckM</li>
<li>Chromosome Coverage: TBD</li>
<li>Genome size (Mb): BBmap</li>
<li>Contigs (no.): BBmap</li>
<li>N50 (bp): BBmap</li>
<li>Gaps (%): TBD</li>
<li>GC content: CheckM</li>
<li>Circularized: Circlator/Flye</li>
<li>Coding Density (%): CheckM</li>
<li>Tetra nucleotides: CheckM</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">BC01</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">BC02</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">BC03</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>BC01_0P_0C</th>
<th>BC01_1P_0C</th>
<th>BC01_0P_1C</th>
<th>BC01_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strain</td>
<td>CCAH7</td>
<td>CCAH7</td>
<td>CCAH7</td>
<td>CCAH7</td>
</tr>
<tr class="even">
<td>Completeness (%)</td>
<td>100.00</td>
<td>98.97</td>
<td>100.00</td>
<td>98.97</td>
</tr>
<tr class="odd">
<td>Contamination (%)</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td>Chromosome coverage</td>
<td>636</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Genome size (Mb)</td>
<td>5,898,925</td>
<td>5,896,968</td>
<td>5,892,140</td>
<td>5,897,021</td>
</tr>
<tr class="even">
<td>Contigs (no.)</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td>N50 (bp)</td>
<td>4,904,000</td>
<td>4,903,000</td>
<td>4,904,000</td>
<td>4,903,000</td>
</tr>
<tr class="even">
<td>Gaps (%)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>GC content</td>
<td>0.5242</td>
<td>0.5242</td>
<td>0.5242</td>
<td>0.5242</td>
</tr>
<tr class="even">
<td>Circularized (*)</td>
<td>4*</td>
<td></td>
<td>3*</td>
<td>3*</td>
</tr>
<tr class="odd">
<td>Coding Density (%)</td>
<td>86.80</td>
<td>86.40</td>
<td>86.80</td>
<td>86.40</td>
</tr>
<tr class="even">
<td>Tetra nucleotides</td>
<td>0.08</td>
<td>0.09</td>
<td>0.02</td>
<td>0.09</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>BC02_0P_0C</th>
<th>BC02_1P_0C</th>
<th>BC02_0P_1C</th>
<th>BC02_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strain</td>
<td>CCAH11</td>
<td>CCAH11</td>
<td>CCAH11</td>
<td>CCAH11</td>
</tr>
<tr class="even">
<td>Completeness (%)</td>
<td>100.00</td>
<td>99.35</td>
<td>100.00</td>
<td>99.35</td>
</tr>
<tr class="odd">
<td>Contamination (%)</td>
<td>1.60</td>
<td>1.30</td>
<td>1.60</td>
<td>1.30</td>
</tr>
<tr class="even">
<td>Chromosome coverage</td>
<td>499</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Genome size (Mb)</td>
<td>5,691,748</td>
<td>5,688,479</td>
<td>5,691,751</td>
<td>5,688,508</td>
</tr>
<tr class="even">
<td>Contigs (no.)</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td>N50 (bp)</td>
<td>3,527,000</td>
<td>3,526,000</td>
<td>3,527,000</td>
<td>3,526,000</td>
</tr>
<tr class="even">
<td>Gaps (%)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>GC content</td>
<td>0.4325</td>
<td>0.4325</td>
<td>0.4325</td>
<td>0.4325</td>
</tr>
<tr class="even">
<td>Circularized (*)</td>
<td>1</td>
<td></td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Coding Density (%)</td>
<td>88.10</td>
<td>87.90</td>
<td>88.10</td>
<td>87.90</td>
</tr>
<tr class="even">
<td>Tetra nucleotides</td>
<td>0</td>
<td>0.05</td>
<td>0.05</td>
<td>0.05</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>BC03_0P_0C</th>
<th>BC03_1P_0C</th>
<th>BC03_0P_1C</th>
<th>BC03_1P_1C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strain</td>
<td>CCAH3</td>
<td>CCAH3</td>
<td>CCAH3</td>
<td>CCAH3</td>
</tr>
<tr class="even">
<td>Completeness (%)</td>
<td>98.68</td>
<td>98.68</td>
<td>98.68</td>
<td>98.68</td>
</tr>
<tr class="odd">
<td>Contamination (%)</td>
<td>1.10</td>
<td>1.10</td>
<td>1.10</td>
<td>1.10</td>
</tr>
<tr class="even">
<td>Chromosome coverage</td>
<td>82</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Genome size (Mb)</td>
<td>4,416,806</td>
<td>4,416,701</td>
<td>4,416,806</td>
<td>4,416,701</td>
</tr>
<tr class="even">
<td>Contigs (no.)</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td>N50 (bp)</td>
<td>3,160,000</td>
<td>3,160,000</td>
<td>3,160,000</td>
<td>3,160,000</td>
</tr>
<tr class="even">
<td>Gaps (%)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>GC content</td>
<td>0.4861</td>
<td>0.4861</td>
<td>0.4861</td>
<td>0.4861</td>
</tr>
<tr class="even">
<td>Circularized (*)</td>
<td>1</td>
<td></td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Coding Density (%)</td>
<td>86.30</td>
<td>86.30</td>
<td>86.30</td>
<td>86.30</td>
</tr>
<tr class="even">
<td>Tetra nucleotides</td>
<td>0</td>
<td>0.08</td>
<td>0.08</td>
<td>0.08</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="discussion-1" class="level3">
<h3 class="anchored" data-anchor-id="discussion-1">Discussion</h3>
<p>After assessing all data generated and through discussion with colleagues I decided to continue working with the un-polished circularized assemblies. It seems as the polishing and alignment did not effect the quality in a significant manner while circlator seems to have un-circularized some contigs that may actually not be circular.</p>
</section>
<section id="table-of-final-assemblies" class="level3">
<h3 class="anchored" data-anchor-id="table-of-final-assemblies">Table of Final Assemblies</h3>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>BC01</th>
<th>BC02</th>
<th>BC03</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strain</td>
<td>CCAH7</td>
<td>CCAH11</td>
<td>CCAH3</td>
</tr>
<tr class="even">
<td>Completeness (%)</td>
<td>100.00</td>
<td>100.00</td>
<td>98.68</td>
</tr>
<tr class="odd">
<td>Contamination (%)</td>
<td>0.00</td>
<td>1.60</td>
<td>1.10</td>
</tr>
<tr class="even">
<td>Chromosome coverage</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Genome size (Mb)</td>
<td>5,892,140</td>
<td>5,691,751</td>
<td>4,416,806</td>
</tr>
<tr class="even">
<td>Contigs (no.)</td>
<td>3</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="odd">
<td>N50 (bp)</td>
<td>4,904,000</td>
<td>3,527,000</td>
<td>3,160,000</td>
</tr>
<tr class="even">
<td>Gaps (%)</td>
<td>0</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>GC content</td>
<td>0.5242</td>
<td>0.4325</td>
<td>0.4861</td>
</tr>
<tr class="even">
<td>Circularized (*)</td>
<td>3*</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Coding Density (%)</td>
<td>86.80</td>
<td>88.10</td>
<td>86.30</td>
</tr>
<tr class="even">
<td>Tetra nucleotides</td>
<td>0.02</td>
<td>0.05</td>
<td>0.08</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="taxonomic-classification" class="level1">
<h1>Taxonomic Classification</h1>
<p>In this section we will use GTDB-Tk for a bacterial classification while using NCBI’s blast website to investigate our non chromosome contigs.</p>
<p>First GTDB-Tk’s classify_wf command was run using the GTDB-Tk bacterial database release207_v2 downloaded on 2/15/2024</p>
<pre><code>#!/bin/bash
#SBATCH --job-name=BC01_GTDBTK
#SBATCH --nodes=1
#SBATCH --ntasks=18
#SBATCH --time=20:00:00
#SBATCH --mem=100G

#Variables
export ASSEMBLY=/path/to/BC1_BIN
export OUT=/path/to/BC1

#Commands
gtdbtk classify_wf --genome_dir $ASSEMBLY -x fasta --cpus 16 --out_dir $OUT
</code></pre>
<section id="classify-results" class="level3">
<h3 class="anchored" data-anchor-id="classify-results">Classify Results</h3>
<section id="bc01-3" class="level4">
<h4 class="anchored" data-anchor-id="bc01-3">BC01</h4>
<p>classified as <em>Pseudovibrio denitrificans</em> the closest reference genome usde for comparison was <strong><a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_001310815.1/">GCF_001310815.1</a></strong> with an ANI of <strong>95.29%</strong> and a MSA percent of <strong>98.29%</strong></p>
</section>
<section id="bc02-3" class="level4">
<h4 class="anchored" data-anchor-id="bc02-3">BC02</h4>
<p>classified as <em>Pseudoalteromonas elyakovii</em> the closest reference genome usde for comparison was <strong><a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000814665.1/">GCA_000814665.1</a></strong> with an ANI of <strong>97.29%</strong> and a MSA percent of <strong>97.78%</strong></p>
</section>
<section id="bc03-3" class="level4">
<h4 class="anchored" data-anchor-id="bc03-3">BC03</h4>
<p>classified as <em>Rossellomorea marisflavi_A</em> the closest reference genome usde for comparison was <strong><a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_009806575.1/">GCF_009806575.1</a></strong> with an ANI of <strong>98.92%</strong> and a MSA percent of <strong>91.84%</strong></p>
</section>
</section>
<section id="classify-discussion" class="level3">
<h3 class="anchored" data-anchor-id="classify-discussion">Classify Discussion</h3>
<p>When interpreting our results we are looking for two separate values being the Average Nucleotide Identity (ANI) and Multiple Sequence Alignment (MSA). ANI measures the overall similarity between two DNA sequences giving us a percentage of how many nts line up while MSA indicates a high level of alignment between our assembly and the reference genome. Since all of our ANI’s are over 95% we can conclude that the taxonomic assignment is correct, while the MSA supports that GTDB-Tk was able to align and make conclusions properly.</p>
</section>
<section id="blasting-individual-contigs" class="level3">
<h3 class="anchored" data-anchor-id="blasting-individual-contigs">Blasting Individual Contigs</h3>
<p><strong><em>DISCUSS WITH RAUL</em></strong> - Not Finished</p>
<p>The aim of this section was to blast all of the non-chromosome sections and evaluate whether or not our contigs were plasmids or DNA pertaining to other Bacteria.</p>
<section id="bc01-4" class="level4">
<h4 class="anchored" data-anchor-id="bc01-4">BC01</h4>
<p>When blasting the contigs pertaining to BC01 we found the following accession numbers for contig three and four: <strong><a href="https://www.ncbi.nlm.nih.gov/nuccore/CP128431.1/">CP128431.1</a></strong> and <strong><a href="https://www.ncbi.nlm.nih.gov/nuccore/CP074127.1/">CP074127.1</a></strong> respectively</p>
</section>
<section id="bc02-4" class="level4">
<h4 class="anchored" data-anchor-id="bc02-4">BC02</h4>
<p>When blasting the contigs pertaining to BC02 we found the following accession numbers for contig two, four, and five:</p>
</section>
<section id="bc03-4" class="level4">
<h4 class="anchored" data-anchor-id="bc03-4">BC03</h4>
<p>When blasting the contigs pertaining to BC03 we found the following accession numbers for contig</p>
</section>
</section>
</section>
<section id="genome-annotation" class="level1">
<h1>Genome Annotation</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="Notebook_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>